<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Liczenie czasu czynno≈õci</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; font-family: Arial, sans-serif; }
        body { display: flex; height: 100vh; }
        
        /* Menu boczne */
        .sidebar {
            width: 220px;
            background: #2c3e50;
            color: white;
            padding: 20px;
            display: flex;
            flex-direction: column;
        }
        .sidebar h2 { text-align: center; margin-bottom: 20px; }
        .sidebar a {
            display: block;
            padding: 10px;
            color: white;
            text-decoration: none;
            margin-bottom: 10px;
            background: #34495e;
            text-align: center;
            border-radius: 5px;
        }
        .sidebar a:hover { background: #1abc9c; }

        /* G≈Ç√≥wna zawarto≈õƒá */
        .content {
            flex-grow: 1;
            padding: 20px;
        }
        .hidden { display: none; }
        
        /* Formularz liczenia czasu */
        select, button, input {
            font-size: 16px;
            margin: 10px;
            padding: 10px;
        }
        #results { margin-top: 20px; text-align: left; }
    </style>
</head>
<body>

    <!-- Sidebar (Menu boczne) -->
    <div class="sidebar">
        <h2>Menu</h2>
        <a href="#" onclick="showPage('home')">üè† Strona G≈Ç√≥wna</a>
        <a href="#" onclick="showPage('timer')">‚è± Liczenie czasu</a>
    </div>

    <!-- G≈Ç√≥wna zawarto≈õƒá -->
    <div class="content">
        
        <!-- Strona G≈Ç√≥wna -->
        <div id="home">
            <h1>Witaj na stronie!</h1>
            <p>Ta aplikacja pozwala na mierzenie czasu wykonywania r√≥≈ºnych czynno≈õci i eksport wynik√≥w do pliku Excel.</p>
            <p>Przejd≈∫ do zak≈Çadki <b>Liczenie czasu</b>, aby rozpoczƒÖƒá.</p>
        </div>

        <!-- Liczenie czasu -->
        <div id="timer" class="hidden">
            <h2>Wybierz czynno≈õƒá i mierz czas</h2>
            <select id="taskSelect">
                <option value="Praca">Praca</option>
                <option value="ƒÜwiczenia">ƒÜwiczenia</option>
                <option value="Nauka">Nauka</option>
                <option value="Odpoczynek">Odpoczynek</option>
            </select>
            
            <button id="startButton">Start</button>
            <button id="stopButton" disabled>Stop</button>
            <button id="exportButton">üìÇ Eksportuj do XLSX</button>
            <button id="clearButton">üóë Wyczy≈õƒá wyniki</button>
            
            <h3>Filtruj wyniki</h3>
            <label>Od: <input type="date" id="startDate"></label>
            <label>Do: <input type="date" id="endDate"></label>
            <button id="filterButton">üîç Filtruj</button>

            <h3>Wyniki</h3>
            <ul id="results"></ul>
        </div>

    </div>

    <script>
        let startTime;
        let resultsArray = [];

        // Funkcja prze≈ÇƒÖczania zak≈Çadek
        function showPage(page) {
            document.getElementById('home').classList.add('hidden');
            document.getElementById('timer').classList.add('hidden');
            document.getElementById(page).classList.remove('hidden');
        }

        document.getElementById('startButton').addEventListener('click', function() {
            startTime = new Date();
            document.getElementById('stopButton').disabled = false;
            this.disabled = true;
        });

        document.getElementById('stopButton').addEventListener('click', function() {
            const endTime = new Date();
            const elapsedTime = new Date(endTime - startTime);
            const hours = String(elapsedTime.getUTCHours()).padStart(2, '0');
            const minutes = String(elapsedTime.getUTCMinutes()).padStart(2, '0');
            const seconds = String(elapsedTime.getUTCSeconds()).padStart(2, '0');

            const selectedTask = document.getElementById('taskSelect').value;
            const date = new Date().toISOString().split('T')[0];
            const resultText = `${date} | ${selectedTask}: ${hours}:${minutes}:${seconds}`;
            
            resultsArray.push({ Data: date, Czynno≈õƒá: selectedTask, Czas: `${hours}:${minutes}:${seconds}` });

            // Zapisz wyniki do LocalStorage
            localStorage.setItem('results', JSON.stringify(resultsArray));

            displayResults(resultsArray);
            
            document.getElementById('startButton').disabled = false;
            this.disabled = true;
        });

        // Wczytaj zapisane wyniki po uruchomieniu strony
        function loadResults() {
            const savedResults = localStorage.getItem('results');
            if (savedResults) {
                resultsArray = JSON.parse(savedResults);
                displayResults(resultsArray);
            }
        }

        // Funkcja do wy≈õwietlania wynik√≥w
        function displayResults(results) {
            const resultsList = document.getElementById('results');
            resultsList.innerHTML = "";
            results.forEach(result => {
                const resultItem = document.createElement('li');
                resultItem.textContent = `${result.Data} | ${result.Czynno≈õƒá}: ${result.Czas}`;
                resultsList.appendChild(resultItem);
            });
        }

        // Filtruj wyniki po dacie
        document.getElementById('filterButton').addEventListener('click', function() {
            const startDate = document.getElementById('startDate').value;
            const endDate = document.getElementById('endDate').value;

            if (!startDate || !endDate) {
                alert("Wybierz zakres dat!");
                return;
            }

            const filteredResults = resultsArray.filter(result => result.Data >= startDate && result.Data <= endDate);
            displayResults(filteredResults);
        });

        // Eksport do XLSX
        document.getElementById('exportButton').addEventListener('click', function() {
            if (resultsArray.length === 0) {
                alert("Brak danych do eksportu!");
                return;
            }

            const worksheet = XLSX.utils.json_to_sheet(resultsArray);
            const workbook = XLSX.utils.book_new();
            XLSX.utils.book_append_sheet(workbook, worksheet, "Wyniki");

            XLSX.writeFile(workbook, "wyniki.xlsx");
        });

        // Czyszczenie wynik√≥w
        document.getElementById('clearButton').addEventListener('click', function() {
            if (confirm("Czy na pewno chcesz usunƒÖƒá wszystkie wyniki?")) {
                resultsArray = [];
                localStorage.removeItem('results');
                displayResults([]);
            }
        });

        // Wczytaj wyniki na start
        window.onload = loadResults;
    </script>

</body>
</html>
